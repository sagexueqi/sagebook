# Thinking in Architecture

## 什么是架构

**从理论到技术，从技术到工程**

**我们做架构设计的目的：** 就是做问题与需求的拆分，为了解决问题而分解出各个子系统与模块，并定义之间的关系以及输入输出项、计算的模式与方法(即`规格`)。

架构可以分为：`基础架构、业务架构、应用架构、数据架构、安全架构、网络架构`

每一个方向都是聚焦解决一类问题：中间件问题、企业业务模式、应用系统的组织方式与技术选型、数据治理、安全治理和网络治理等。领域不一样，解决的问题也就不一样，但目标都是一致的。站在组织的角度，扫清组织发展过程中的技术障碍。

研发同学专注方案的落地，架构同学专注于方案的提出与可行性验证。

**我们做架构设计的准则：** 

- 为领域或组织面对的`核心问题`，提出具有`针对性`的解决方案: 因为核心问题是相对稳定的，是需要集中精力去打磨和设计的，要`Case by Case`的去解决

- 为领域或组织面对的`变化性的问题`，提出具有`通用性`的解决方案：变化性的问题可能并不是组织对外提供的核心能力，或者说是为组织创造价值的辅助功能（DDD中的支撑域或通用域）；类似于文件服务，我们的持久化可能会对接`S3`、`阿里云`或自建的File Paas服务，但我们在设计对外接口时，一定是要屏蔽各个存储方案的差异性，而提供通用的文件API

**架构师的角色定位**

相较于技术经理或技术负责人，只对本团队负责；架构师既是`协调方`：要对业务线的多个团队直接的合作、领域、业务划分进行协调，同时也是`妥协方`：理想中的方案与实际落地时的情况一定有所偏差，作为架构师要接受这种不完美，并将风险降低到可控范围内的最小值，这个过程也是需要与多方沟通协调和妥协的

## 架构设计过程中，理论如何指导实际

在架构设计的过程中，我们的工具箱中有很多理论方法可以指导我们。所有的方法论都不是照搬就可以复用，即架构设计中没有`银弹`。

**DDD**

- 在业务架构设计的过程中，我们可以参考DDD中战略设计阶段，将业务需求拆解为`核心域`、`支撑域`、`通用域`的方式，将一个问题划分为多个问题域，交由不同的团队实现与完成；

- 在应用架构设计的阶段，将问题域逐步拆解为多个子域，并通过子域关系指导限界上下文的映射关系，进而进行微服务的规划与划分；

>我们的理想状态是一个限界上下文就是一个微服务，实际很难，我们保证的是多个微服务都属于一个限界上下文

- 即便是在以`MVC`模式组织的应用架构中，也可以识别实体、聚合，采用胀血模型对领域对象的动作进行封装；采用DDD的应用架构模式，封装infra层，以实现业务与技术分离；

**SOLID原则**

> Single Responsibility Principle：单一职责原则（SRP）
>
> Open Closed Principle：开闭原则（OCP）
>
> Liskov Substitution Principle：里氏替换原则（LSP）
>
> Law of Demeter：迪米特法则（LD与LSP合并为同一个L）
>
> Interface Segregation Principle：接口隔离原则（ISP）
>
> Dependence Inversion Principle：依赖倒置原则（DIP）

- 无论是采用DDD还是MVC，在进行微服务或者功能模块划分时，`单一职责`原则是一直贯穿其中的；我们有这么多设计规约、范式，目的也是在于某一个某块的功能足够聚合、单一

- 开闭原则、DIP原则等，指导我们在软件编码过程中的设计规范与模块间的组织关系

**全局视角**

- 横向视角：从数据流横向流转的角度看待数据的生命周期 (数据流)

- 纵向视角：在数据流转消费的每一个节点，纵向的去梳理业务逻辑 (业务流、资金流)

- 将复杂的问题，逐步化解为一个个独立的问题，将独立的问题，逐步化解为一个个标准化方案可以处理的问题；无法标准处理的问题，即业务的核心特性，是领域的`核心问题`
