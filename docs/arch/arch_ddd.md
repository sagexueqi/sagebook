# DDD

## 个人对DDD的一个看法

首先，DDD是一种业务架构设计的流派，不是完美无缺的，一般来说，我们针对大型和复杂业务系统，可以践行DDD；如果是很简单的小型CRUD系统，强往DDD上靠的话，没有太大意义。

比如说，设计清结算会计系统，我个人认为没有必要完全按照DDD的范式，做战略设计和战术设计。因为对于会计领域来说，已经足够的小，可预见的只需要两个三子域（记账、基础、日终），每一个子域的业务动作也足够聚合，可以成为一个限界上下文。更多的在应用架构、工程架构上引入DDD所倡导模式（洋葱架构、胀血模型、实体与聚合）

应该站在一个更高的角度去实践DDD，比如设计支付清结算领域。此时，战略设计阶段，需要根据清结算的整体业务流程，规范通用语言，识别问题域；划分核心域（会计核心域、结算核心域、计费核心域）、支撑域与通用域。在战术设计阶段，在各领域中，识别实体、值对象，形成聚合根，并在各个领域中，将**解决一类问题的聚合根，划分到一个限界上下文中，而这一个限界上下文**，就是一个微服务系统。这也是我们划分微服务的一个标准。

限界上下文之间的关系，其实就是上下文映射。跨限界上下文的交互，我们应该在应用的应用服务中进行编排，形成防腐层（所谓的防腐，就是在于其他限界上下文的交互中，隔离变化，防止其他上下文对当前上下文的污染；防腐层内部是腐化变化的）

而在进行DDD领域模型建模的时候，我们要摒弃一个想法，就是数据表的概念（要想象成，我们的系统是一个大的内存数据库，啥都可以存）。我们要先识别出对象，识别哪些可以称之为实体对象（即有主键，有生命，有真正的业务动作），哪些是值对象（没主键，没生命，有简单动作）。最后形成一个聚合，这个聚合就是一个领域模型，它具有独立而完成的动作。

一个实体，可能会包括多个表的对象，其实我们日常基于ER的思维设计出的数据表也是这样：虽然很多是有属性有主键的，但是是附着于某一张主表的（因为数据库设计，再差也要符合一定的范式规范，不能所有字段都干在一起）。最后在资源库Repository中，对一个实体的CRUD，其实很有可能是对多个表的CRUD，这是一种思维的转换

与其说DDD是将业务与技术分离的架构设计方法论，不如说，DDD更关心的是一个领域模型的动作，如何去编排领域动作完成业务case；其实我们日常的业务架构设计中，也是可以做到业务与技术分离的，只不过我们更多的数据流（哪一步存那个表，取哪一个表），DDD是模型领域流（哪一步是哪一个领域对象或者聚合的哪一个动作完成）推动

----

## 战略设计与战术设计

----

## 应用架构